# Учебник Vala

## Введение

**Отказ от обязательств:** на данный момент проект Vala находится в разработке и его возможности могут изменяться. Я попытаюсь сохранять информацию в этом руководстве актуальной, насколько это возможно, но я не идеален. Так же я не могу обещать, что методы, которые я предлагаю, будут лучшими на практике, но, опять же, я постараюсь держать вас в курсе дела.

### Что такое Vala?

Vala — это новый язык программирования, который позволяет использовать современные способы программирования для написания приложений, которые будут основываться на библиотеках выполнения GNOME, частично GLib и GObject. С давних пор эта платформа является полноценной средой разработки, включая такие особенности как система динамических типов данных и вспомогательные инструменты управления памятью. До создания Vala, единственным способом написания программ для этой платформы было использование API языка C, что приводило к нежелательным последствиям, использованию высокоуровневых скриптовых языков, требующих наличие виртуальной машины, таких как Python, Mono C\#, или, как альтернативный вариант, использование библиотеки-оболочки для C++.

Технология Vala уникальна тем, что генерирует код на языке C, который может быть скомпилирован для запуска без необходимости установки дополнительных библиотек, не включенных в GNOME. Из этого следует:

Производительность программ, написанных на Vala, будет сопоставима с производительностью программ, написанных непосредственно на C. И в то же время, они более просты в написании и сопровождении.

Программы, написанные на Vala, могут делать то же, что и программы, написанные на C. И хотя Vala предоставляет функции, не доступные C программистам, их можно реализовать и на C, но это трудоемкий и сложный процесс.

Как таковой Vala — это современный язык со всеми возможностями, которые только можно себе представить, но, несмотря на это, вся его мощь идет от существующей платформы и соответствует установленным ей правилам.

### Для кого предназначено это руководство?

Данное руководство не углубляется в подробности основ написания программ. Здесь лишь кратко объясняются принципы объектно-ориентированного программирования, подробно рассказывая об основных принципах Vala. Данное руководство окажется полезным, если вы уже имеете опыт программирования, хотя глубокие познания какого-либо языка не требуются.

Синтаксис Vala очень похож на C\#, но я буду стараться избегать описания функций с точки зрения сходства и отличия их от C\# или Java с целью сделать руководство более доступным и понятным.

Для понимания вам будет полезно знание языка C. Хотя это не требуется для понимания самого Vala, важно знать, что он основывается на C и зачастую взаимодействует с его библиотеками. Знание этого языка программирования безусловно облегчит углубленное понимание Vala.

### Условные обозначения

Исходный код программ будет написан моноширинным шрифтом, команды в терминале будут начинаться с символа $. Всё остальное должно быть понятно. Я обычно программирую с подробными комментариями, иногда указывая на то, что уже очевидно. Я постараюсь объяснить случаи, когда что-либо можно опустить, но это не значит, что я советую вам это делать.

Рано или поздно я добавлю ссылки на документацию по Vala, но пока что это невозможно.

Первая программа

К сожалению предсказуемо, но все же:

```java
class Demo.HelloWorld : GLib.Object {
    public static int main(string[] args) {
        stdout.printf("Привет, мир\n");
    return 0;
    }
}
```

Конечно же это "Привет, мир" \(Hello World\), написанный на Vala. Я надеюсь, что некоторые части кода вам уже понятны, но всё равно я объясню всё по порядку.

```java
class Demo.HelloWorld : GLib.Object {
```

Эта строка начинает определение класса. Классы в Vala в общих чертах похожи на классы в других языках. Класс - это тип объекта, экземпляры которого могут быть созданы, обладая одинаковыми свойствами. Реализацией классов занимается библиотека gobject, для общего использования это знать не обязательно.

Нужно отметить, что этот класс является подклассом GLib.Object. Это потому, что Vala также поддерживает другие типы классов, но в большинстве случаев это то, что вам нужно. Фактически, некоторые возможности языка Vala можно использовать только если ваш класс происходит от класса Object из библиотеки GLib.

Другие части этой строки демонстрируют пространства имен и полностью определённые имена, но они будут объяснены позже.

```java
public static int main(string[] args) {
```

Это является началом определения метода. Метод — это функция, связанная с классом, которая может быть вызвана объектом. Если метод является статическим, это означает, что он может быть вызван без привязки к какому-либо экземпляру этого типа. Название метода «main» и наличие подписи означает, что Vala примет его за точку входа в программу.

Метод main не обязательно должен быть объявлен внутри класса. Однако, если он объявлен внутри класса, то он обязательно должен быть статическим, не имеет значения публичным или приватным. Тип возвращаемого значения может быть целочисленным \(int\) или не иметь типа \(void\). Если типом возвращаемого методом значения является void, то программа будет завершаться с кодом выхода 0. Параметр с массивом строк принимает аргументы командной строки и не является обязательным.

```java
stdout.printf("Привет, мир\n");
```

stdout - это объект пространства имён GLib, доступ к которому Vala обеспечивает когда бы это ни понадобилось. Эта строка указывает Vala вызвать метод printf объекта stdout, с приветственной строкой в качестве аргумента. В Vala это обыкновенный синтаксис для вызова методов объектов или для доступа к данным объекта. \n - это экранированная последовательность для перехода на новую строку.

```java
return 0;
```

Функция return возвращает код завершения и прекращает выполнение метода main, который в свою очередь завершает выполнение программы. Возвращённое значение является кодом завершения программы.

Последние строки просто завершают определения метода и класса.

### Компиляция и запуск

Если у вас установлен Vala, то все, что нужно для компиляции и запуска программы это:

```bash
valac hello.vala
./hello
```

valac - это компилятор Vala, создающий двоичный исполняемый файл. В результате двоичный файл будет иметь то же имя, что и файл исходного кода. Сразу после компиляции файл может быть запущен на компьютере. Возможно, вы уже догадались, каков результат его работы.

